{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-05T15:50:36.326590Z", "invocation_id": "5b2721b7-7f84-480c-9f60-7110e346c749", "invocation_started_at": "2026-02-05T15:50:35.939890Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.266114Z", "completed_at": "2026-02-05T15:50:36.269642Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.269821Z", "completed_at": "2026-02-05T15:50:36.269827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004070758819580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive__activity", "compiled": true, "compiled_code": "SELECT \n  activity_id,\n  type,\n  deal_id,            \n  done::boolean AS done,\n  CAST(due_to AS TIMESTAMP) AS activity_date  \nFROM \"postgres\".\"public\".\"activity\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.270666Z", "completed_at": "2026-02-05T15:50:36.271763Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.271902Z", "completed_at": "2026-02-05T15:50:36.271905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015769004821777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive__activity_types", "compiled": true, "compiled_code": "SELECT id AS activity_type_id, \nname ,\ntype AS activity_type_code\nFROM \"postgres\".\"public\".\"activity_types\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.272709Z", "completed_at": "2026-02-05T15:50:36.273811Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.273950Z", "completed_at": "2026-02-05T15:50:36.273954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001589059829711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes", "compiled": true, "compiled_code": "SELECT \n  deal_id,\n  CAST(change_time AS TIMESTAMP) AS change_time,\n  changed_field_key,\n  new_value\nFROM \"postgres\".\"public\".\"deal_changes\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.274683Z", "completed_at": "2026-02-05T15:50:36.275849Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.276008Z", "completed_at": "2026-02-05T15:50:36.276013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016570091247558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_pipedrive__stages", "compiled": true, "compiled_code": "SELECT stage_id, stage_name\nFROM \"postgres\".\"public\".\"stages\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.276728Z", "completed_at": "2026-02-05T15:50:36.278622Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.278765Z", "completed_at": "2026-02-05T15:50:36.278768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002376079559326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_sales_calls", "compiled": true, "compiled_code": "SELECT \n  a.deal_id,\n  CASE \n    WHEN t.name = 'Sales Call 1' THEN '2.1'\n    WHEN t.name = 'Sales Call 2' THEN '3.1'\n  END AS funnel_step,\n  t.name AS kpi_name,\n  MIN(a.activity_date) AS call_time\nFROM \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__activity\" a\nJOIN \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__activity_types\" t \n  ON a.type = t.activity_type_code\nWHERE a.done = TRUE\n  AND t.name IN ('Sales Call 1', 'Sales Call 2')\nGROUP BY a.deal_id, t.name", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"int_deal_sales_calls\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.279446Z", "completed_at": "2026-02-05T15:50:36.308519Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.308681Z", "completed_at": "2026-02-05T15:50:36.308685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029562950134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        changed_field_key as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"\n    group by changed_field_key\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'user_id','stage_id','lost_reason','add_time'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.309382Z", "completed_at": "2026-02-05T15:50:36.312432Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.312565Z", "completed_at": "2026-02-05T15:50:36.312568Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035037994384765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.313199Z", "completed_at": "2026-02-05T15:50:36.314741Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.314882Z", "completed_at": "2026-02-05T15:50:36.314885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001979827880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect changed_field_key\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"\nwhere changed_field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.315534Z", "completed_at": "2026-02-05T15:50:36.316990Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.317130Z", "completed_at": "2026-02-05T15:50:36.317132Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018951892852783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.317761Z", "completed_at": "2026-02-05T15:50:36.319236Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.319377Z", "completed_at": "2026-02-05T15:50:36.319379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019099712371826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_value\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\"\nwhere new_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.320006Z", "completed_at": "2026-02-05T15:50:36.321355Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.321498Z", "completed_at": "2026-02-05T15:50:36.321500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017900466918945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_stage_entries", "compiled": true, "compiled_code": "WITH stage_changes AS (\n  SELECT dc.deal_id, \n         CAST(dc.new_value AS INTEGER) AS stage_id,\n         dc.change_time,\n         ROW_NUMBER() OVER (\n             PARTITION BY dc.deal_id, dc.new_value \n             ORDER BY dc.change_time\n         ) AS stage_change_rank\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\" dc\n  WHERE dc.changed_field_key = 'stage_id'\n)\nSELECT sc.deal_id, sc.stage_id, sc.change_time AS stage_change_time\nFROM stage_changes sc\nJOIN \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__stages\" s \n  ON sc.stage_id = s.stage_id\nWHERE sc.stage_change_rank = 1", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"int_deal_stage_entries\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.322273Z", "completed_at": "2026-02-05T15:50:36.323707Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.323833Z", "completed_at": "2026-02-05T15:50:36.323836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001857757568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_deal_funnel_events", "compiled": true, "compiled_code": "WITH deals_created AS (\n  SELECT \n    dc.deal_id,\n    '1' AS funnel_step,\n    'Lead Generation' AS kpi_name,\n    MIN(dc.change_time) AS event_time\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__deal_changes\" dc\n  WHERE dc.changed_field_key = 'add_time'\n  GROUP BY dc.deal_id\n),\nstage_entries AS (\n  SELECT \n    se.deal_id,\n    CAST(se.stage_id AS VARCHAR) AS funnel_step,  \n    s.stage_name AS kpi_name,\n    se.stage_change_time AS event_time\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"int_deal_stage_entries\" se\n  JOIN \"postgres\".\"public_pipedrive_analytics\".\"stg_pipedrive__stages\" s \n    ON se.stage_id = s.stage_id\n),\nsales_calls AS (\n  SELECT \n    deal_id,\n    funnel_step,\n    kpi_name,\n    call_time AS event_time\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"int_deal_sales_calls\"\n)\nSELECT * FROM deals_created\nUNION ALL\nSELECT * FROM stage_entries\nUNION ALL\nSELECT * FROM sales_calls", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"int_deal_funnel_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T15:50:36.324639Z", "completed_at": "2026-02-05T15:50:36.325769Z"}, {"name": "execute", "started_at": "2026-02-05T15:50:36.325901Z", "completed_at": "2026-02-05T15:50:36.325903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015959739685058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "\n\nSELECT \n  date_trunc('month', event_time) AS month,\n  funnel_step,\n  kpi_name,\n  COUNT(DISTINCT deal_id) AS deals_count\nFROM \"postgres\".\"public_pipedrive_analytics\".\"int_deal_funnel_events\"\nGROUP BY \n  date_trunc('month', event_time),\n  funnel_step,\n  kpi_name\nORDER BY \n  month,\n  funnel_step", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"rep_sales_funnel_monthly\"", "batch_results": null}], "elapsed_time": 0.14011192321777344, "args": {"exclude": [], "require_resource_names_without_spaces": true, "show_resource_report": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "project_dir": "/Users/amithnair/Documents/dbt_enpal_assessment-main", "vars": {}, "write_json": true, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "upload_to_artifacts_ingest_api": false, "require_unique_project_resource_names": false, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse_file_diff": true, "populate_cache": true, "require_ref_searches_node_package_before_root": false, "defer": false, "require_nested_cumulative_type_params": false, "use_colors": true, "log_level": "info", "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "static_parser": true, "version_check": true, "show_all_deprecations": false, "favor_state": false, "log_format": "default", "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "which": "generate", "require_generic_test_arguments_property": true, "indirect_selection": "eager", "empty_catalog": false, "invocation_command": "dbt docs generate", "select": [], "print": true, "compile": true, "log_path": "/Users/amithnair/Documents/dbt_enpal_assessment-main/logs", "use_fast_test_edges": false, "require_all_warnings_handled_by_warn_error": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "macro_debugging": false, "quiet": false, "static": false, "log_format_file": "debug", "validate_macro_args": false, "state_modified_compare_vars": false, "profiles_dir": "/Users/amithnair/.dbt", "partial_parse": true, "printer_width": 80, "cache_selected_only": false, "strict_mode": false}}